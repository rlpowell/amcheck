{
  imapserver: "localhost",
  login: "weeble",
  // Note that "pass" is the literal password that dovecot expects in testing
  // mode; it doesn't care about the login name
  password: "pass",
  handlers: [
    {
      name: "Puppet Runs OK And At Least Once In The Past Day",
      filters: [
        { Match: { From: " <root@" } },
        { Match: { Subject: "^Cron " } },
        { Match: { Subject: "puppet agent" } },
      ],
      checker_tree: {
        BodyCheck: {
          string: "Notice: Applied catalog in",
          matched: {
            DateCheck: {
              days: 1,
              older_than: {
                Action: "Delete"
              },
              younger_than: {
                CountCheck: {
                  count: 1,
                  greater_than: { Action: "Success" },
                  equal: { Action: "Success" },
                  less_than: { Action: "Alert" },
                },
              },
            },
          },
          not_matched: { Action: "Alert" },
        },
      },
    },
    // This is not really a check that makes sense; it's just there to test a
    // problem we had where deleting mails based on sequence number caused the
    // next set of deletions to fail because the sequence numbers no longer
    // matched.
    {
      name: "delete rsync_backup_wrapper mail",
      filters: [
        { Match: { Subject: "^Cron .*rsync_backup_wrapper" } },
      ],
      checker_tree: {
        MatchCheck: {
          matchers: [],
          matched: { Action: "Delete" },
          not_matched: { Action: "Alert" },
        }
      }
    }
  ]
}
