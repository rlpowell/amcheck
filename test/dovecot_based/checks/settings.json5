{
  imapserver: "localhost",
  login: "weeble",
  // Note that "pass" is the literal password that dovecot expects in testing
  // mode; it doesn't care about the login name
  password: "pass",
  matcher_sets: [],
  checker_sets: [
    {
      name: "Puppet Runs OK",
      matchers: [
        { Match: { From: " <root@" } },
        { Match: { Subject: "^Cron " } },
        { Match: { Subject: "puppet agent" } },
      ],
      dates: [
        {
          OlderThan: 1
        },
      ],
      checks: [
        {
          "CheckIndividual": {
            matchers: [
              { Match: { Body: "Notice: Applied catalog in" } },
            ],
            actions: { matched: "Delete", unmatched: "Alert" },
          }
        }
      ]
    },
    {
      name: "Puppet Runs At Least Once A Day",
      matchers: [
        { Match: { From: " <root@" } },
        { Match: { Subject: "^Cron " } },
        { Match: { Subject: "puppet agent" } },
      ],
      dates: [
        { YoungerThan: 2 },
      ],
      checks: [
        {
          CheckCount: {
            AtLeast: 1,
          }
        },
      ]
    },
    // This is not really a check that makes sense; it's just there to test a
    // problem we had where deleting mails based on sequence number caused the
    // next set of deletions to fail because the sequence numbers no longer
    // matched.
    {
      name: "delete rsync_backup_wrapper mail",
      matchers: [
        { Match: { Subject: "^Cron .*rsync_backup_wrapper" } },
      ],
      dates: [],
      checks: [
        {
          "CheckIndividual": {
            matchers: [],
            actions: { matched: "Delete", unmatched: "Alert" },
          }
        }
      ]
    }
  ]
}
